function [X_PH3_eq]=PH3equ(T,PG,X_H2,X_H2O,X_P)
% equilibrium between PH3 and H3PO4

% nasa polynomial for PH3
PH3_nasa_coeff_low = [4.17009763E+00, -5.06487157E-03, ...
               2.86027846E-05, -3.13123782E-08, 1.13447768E-11, ...
              2.03144445E+02, 2.02004617E+00  ];
PH3_nasa_coeff_high = [ 3.71229298E+00, 5.85959002E-03, ...
              -2.16607791E-06, 3.56195511E-10, -2.15913467E-14, ...  
              -1.88863997E+02, 1.92781913E+00];
G_0_PH3 = evaluate_NASA_poly(PH3_nasa_coeff_low,PH3_nasa_coeff_high,T);

% nasa polynomial for H2O
H2O_nasa_coeff_low = [4.198640560E+00,  -2.036434100E-03, ...
                6.520402110E-06,  -5.487970620E-09,   1.771978170E-12,...
               -3.029372670E+04,  -8.490322080E-01];
H2O_nasa_coeff_high = [ 3.033992490E+00,   2.176918040E-03, ...
               -1.640725180E-07,  -9.704198700E-11,   1.682009920E-14, ...
               -3.000429710E+04,   4.966770100E+00];
G_0_H2O = evaluate_NASA_poly(H2O_nasa_coeff_low,H2O_nasa_coeff_high,T);

% nasa polynomial for H2
H2_nasa_coeff_low = [2.344331120E+00,   7.980520750E-03, ... 
               -1.947815100E-05,   2.015720940E-08,  -7.376117610E-12, ...
               -9.179351730E+02,   6.830102380E-01];
H2_nasa_coeff_high = [ 3.337279200E+00,  -4.940247310E-05, ... 
                4.994567780E-07,  -1.795663940E-10,   2.002553760E-14, ...
               -9.501589220E+02,  -3.205023310E+00];
G_0_H2 = evaluate_NASA_poly(H2_nasa_coeff_low,H2_nasa_coeff_high,T);

% nasa polynomial for H3PO4(g)
H3PO4_nasa_coeff_low = [-1.82480022E+00, 6.92983740E-02, ...
              -1.01448758E-04, 6.91910155E-08, -1.77690951E-11, ...
               -1.36317149E+05, 3.30354162E+01];
H3PO4_nasa_coeff_high = [ 1.38520189E+01, 4.93643885E-03, ...
             -1.55822515E-06, 2.29340638E-10, -1.28366239E-14, ...
              -1.39420678E+05, -4.22913846E+01];
G_0_H3PO4 = evaluate_NASA_poly(H3PO4_nasa_coeff_low,H3PO4_nasa_coeff_high,T);

G_0_reaction = G_0_H3PO4 + 4*G_0_H2 - G_0_PH3 - 4*G_0_H2O;

Rgas = 8.3145e-3;
K_eq = exp(-G_0_reaction/(Rgas*T));

alpha = K_eq*X_H2O^4/X_H2^4;

X_PH3_eq = X_P/(1+alpha);
end
