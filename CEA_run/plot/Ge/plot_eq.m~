% equilibrium plots

clear all;
close all;

directory = ' /Users/wangdong/Documents/2015_summer/research/CEA_run/data/Jupiter/new_Ge/4.4_solar/';
fid = fopen(strcat(directory,'Saturn_1.plt'),'r');
% specify number of t,p+species
n_column = 17;

if fid>=0
   fscanf(fid,'%s',1);
   s = cell(n_column);
   for i=1:n_column
       s{i} = fscanf(fid,'%s',1);
   end
   data_1 = fscanf(fid,'%f');
   data_1 = reshape(data_1,n_column,100);
   data_1 = data_1';
   data_short_1 = data_1(1:11:end,:);
end
fclose(fid);

fid = fopen(strcat(directory,'Saturn_2.plt'),'r');
if fid>=0
   fscanf(fid,'%s',1);
   s = cell(n_column);
   for i=1:n_column
       s{i} = fscanf(fid,'%s',1);
   end
   data_2 = fscanf(fid,'%f');
   data_2 = reshape(data_2,n_column,100);
   data_2 = data_2';
   data_short_2 = data_2(1:11:end,:);
end
fclose(fid);

fid = fopen(strcat(directory,'Saturn_3.plt'),'r');
if fid>=0
   fscanf(fid,'%s',1);
   s = cell(n_column);
   for i=1:n_column
       s{i} = fscanf(fid,'%s',1);
   end
   data_3 = fscanf(fid,'%f');
   data_3 = reshape(data_3,n_column,25);
   data_3 = data_3';
   data_short_3 = data_3(1:6:end,:);
end
fclose(fid);

data_short = [data_short_1;data_short_2;data_short_3];

set(gca,'FontSize',n_column);
T = data_short(:,1);
plot(data_short(:,3),T,'k-','LineWidth',2);
xlim([1e-20,1e-7])
ylim([300,1500])
set(gca,'xscale','log')
xlabel('mole fraction','interpreter','latex')
ylabel('T(K)','interpreter','latex')
grid on;

hold on;
for i=4:n_column
    plot(data_short(:,i),T,'k-','LineWidth',2);
end

%legend('Ge', 'GeBr', 'GeBr2', 'GeCl', 'GeCl2'...
%    , 'GeF', 'GeF2', 'GeH4', 'GeO', 'GeS', 'GeS2',...
%    'Ge2', 'Ge(cr)', 'GeO2(II)')


% Create textbox
annotation('textbox',...
    [0.173125000000002 0.783285714285714 0.048046875 0.0485714285714286],...
    'String',{'Ge_2'},...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.252031250000001 0.676142857142857 0.048046875 0.0485714285714286],...
    'String',{'GeS_2'},...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.739531250000002 0.734714285714285 0.048046875 0.0485714285714286],...
    'String',{'GeH_4'},...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.843750000000002 0.721857142857142 0.048046875 0.0485714285714286],...
    'String',{'GeS'},...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.845781250000001 0.274714285714286 0.048046875 0.0485714285714286],...
    'String',{'Ge(cr)'},...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.766093750000002 0.117571428571428 0.048046875 0.0485714285714286],...
    'String',{'GeO_2(II)'},...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.774375000000002 0.191857142857143 0.048046875 0.0485714285714286],...
    'String',{'GeS(cr)'},...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.632500000000005 0.648999999999999 0.048046875 0.0485714285714286],...
    'String',{'GeO'},...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.535625000000003 0.733285714285714 0.048046875 0.0485714285714286],...
    'String',{'GeCl'},...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.620781250000003 0.379 0.048046875 0.0485714285714286],'String',{'GeF_2'},...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.520000000000003 0.287571428571429 0.048046875 0.0485714285714286],...
    'String',{'GeCl_2'},...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.360625000000002 0.496142857142857 0.048046875 0.0485714285714286],...
    'String',{'GeF'},...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.273125000000003 0.484714285714285 0.048046875 0.0485714285714286],...
    'String',{'GeBr'},...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.216093750000002 0.354714285714285 0.048046875 0.0485714285714286],...
    'String',{'GeBr2'},...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

%% ten times solar water
clear all;
directory = '../../data/Ge/1_solar/10_solar_water/';
fid = fopen(strcat(directory,'Saturn_1.plt'),'r');
n_column=17;
if fid>=0
   fscanf(fid,'%s',1);
   s = cell(n_column);
   for i=1:n_column
       s{i} = fscanf(fid,'%s',1);
   end
   data_1 = fscanf(fid,'%f');
   data_1 = reshape(data_1,n_column,100);
   data_1 = data_1';
   data_short_1 = data_1(1:11:end,:);
end
fclose(fid);

fid = fopen(strcat(directory,'Saturn_2.plt'),'r');
if fid>=0
   fscanf(fid,'%s',1);
   s = cell(n_column);
   for i=1:n_column
       s{i} = fscanf(fid,'%s',1);
   end
   data_2 = fscanf(fid,'%f');
   data_2 = reshape(data_2,n_column,100);
   data_2 = data_2';
   data_short_2 = data_2(1:11:end,:);
end
fclose(fid);

fid = fopen(strcat(directory,'Saturn_3.plt'),'r');
if fid>=0
   fscanf(fid,'%s',1);
   s = cell(n_column);
   for i=1:n_column
       s{i} = fscanf(fid,'%s',1);
   end
   data_3 = fscanf(fid,'%f');
   data_3 = reshape(data_3,n_column,25);
   data_3 = data_3';
   data_short_3 = data_3(1:6:end,:);
end
fclose(fid);

data_short = [data_short_1;data_short_2;data_short_3];

hold on;
T = data_short(:,1);
plot(data_short(:,3),T,'k--','LineWidth',2);

hold on;
for i=4:n_column
    plot(data_short(:,i),T,'k--','LineWidth',2);
end
