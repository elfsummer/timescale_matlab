% equilibrium plots

clear all;
close all;

directory = '/Users/wangdong/Documents/2015_summer/research/CEA_run/data/Si/10_solar/';
fid = fopen(strcat(directory,'Saturn_1.plt'),'r');
% specify number of t,p+species
n_column = 12;

if fid>=0
   fscanf(fid,'%s',1);
   s = cell(n_column);
   for i=1:n_column
       s{i} = fscanf(fid,'%s',1);
   end
   data_1 = fscanf(fid,'%f');
   data_1 = reshape(data_1,n_column,81);
   data_1 = data_1';
   data_short_1 = data_1(1:10:end,:);
end
fclose(fid);

fid = fopen(strcat(directory,'Saturn_2.plt'),'r');
if fid>=0
   fscanf(fid,'%s',1);
   s = cell(n_column);
   for i=1:n_column
       s{i} = fscanf(fid,'%s',1);
   end
   data_2 = fscanf(fid,'%f');
   data_2 = reshape(data_2,n_column,100);
   data_2 = data_2';
   data_short_2 = data_2(1:11:end,:);
end
fclose(fid);

fid = fopen(strcat(directory,'Saturn_3.plt'),'r');
if fid>=0
   fscanf(fid,'%s',1);
   s = cell(n_column);
   for i=1:n_column
       s{i} = fscanf(fid,'%s',1);
   end
   data_3 = fscanf(fid,'%f');
   data_3 = reshape(data_3,n_column,100);
   data_3 = data_3';
   data_short_3 = data_3(1:11:end,:);
end
fclose(fid);

data_short = [data_short_1;data_short_2;data_short_3];

set(gca,'FontSize',20);
T = data_short(:,1);
h1 = plot(data_short(:,3),T,'b-','LineWidth',2);
xlim([1e-20,1e-1])
ylim([400,2000])
set(gca,'xscale','log')
xlabel('mole fraction','interpreter','latex')
ylabel('T(K)','interpreter','latex')
grid on;

hold on;
for i=4:n_column
    plot(data_short(:,i),T,'LineWidth',2);
end
% Create textbox
annotation('textbox',...
    [0.35640625 0.731428571428571 0.0285937500000009 0.0328571428571432],...
    'Interpreter','latex',...
    'String',{'SiO$_2$'},...
    'FontWeight','bold',...
    'FontSize',14,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.816562500000001 0.675714285714286 0.08203125 0.0475714285714285],...
    'Interpreter','latex',...
    'String',{'MgSiO$_3$(III)'},...
    'FontWeight','bold',...
    'FontSize',14,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.817343750000001 0.854285714285714 0.0724999999999994 0.0475714285714285],...
    'Interpreter','latex',...
    'String',{'MgSiO$_3$(L)'},...
    'FontWeight','bold',...
    'FontSize',14,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.8184375 0.444285714285715 0.08203125 0.0475714285714285],...
    'Interpreter','latex',...
    'String',{'MgSiO$_3$(II)'},...
    'FontWeight','bold',...
    'FontSize',14,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.81953125 0.217142857142857 0.08203125 0.0475714285714285],...
    'Interpreter','latex',...
    'String',{'MgSiO$_3$ (I)'},...
    'FontWeight','bold',...
    'FontSize',14,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.692031250000002 0.43 0.0868749999999984 0.0475714285714286],...
    'Interpreter','latex',...
    'String',{'Mg$_2$SiO$_4$ (s)'},...
    'FontWeight','bold',...
    'FontSize',14,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.406250000000003 0.587142857142858 0.0312499999999972 0.0332857142857141],...
    'Interpreter','latex',...
    'String',{'SiO'},...
    'FontWeight','bold',...
    'FontSize',14,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.27890625 0.531428571428571 0.0285937500000009 0.0328571428571432],...
    'Interpreter','latex',...
    'String',{'SiH$_3$'},...
    'FontWeight','bold',...
    'FontSize',14,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.52703125 0.861428571428571 0.0285937500000009 0.0328571428571432],...
    'Interpreter','latex',...
    'String',{'SiH$_2$'},...
    'FontWeight','bold',...
    'FontSize',14,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.552656250000003 0.598571428571429 0.0868749999999984 0.0475714285714286],...
    'Interpreter','latex',...
    'String',{'SiH$_4$'},...
    'FontWeight','bold',...
    'FontSize',14,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.28671875 0.213285714285714 0.108203125 0.0628571428571429],...
    'Interpreter','latex',...
    'String',{'Saturn'},...
    'FontWeight','bold',...
    'FontSize',24,...
    'EdgeColor',[1 1 1]);

